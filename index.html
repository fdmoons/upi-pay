<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secure UPI Payment</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">

<style>
    body{
    margin:0;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:radial-gradient(circle at top,#0f2027,#0a1a2a,#000);
    font-family:'Poppins',sans-serif;
    color:#fff;
    overflow:hidden;
}

/* animated gradient glow */
body::before{
    content:'';
    position:absolute;
    width:420px;
    height:420px;
    background:radial-gradient(circle,#00f260,transparent 60%);
    filter:blur(120px);
    animation:float 7s infinite alternate;
}
@keyframes float{
    from{transform:translate(-120px,-120px)}
    to{transform:translate(140px,140px)}
}

.card{
    width:360px;
    padding:30px;
    border-radius:26px;
    background:rgba(255,255,255,0.10);
    backdrop-filter:blur(20px);
    box-shadow:0 30px 70px rgba(0,0,0,.6);
    text-align:center;
    animation:pop .8s ease;
    z-index:2;
}
@keyframes pop{
    from{opacity:0;transform:scale(.9)}
    to{opacity:1;transform:scale(1)}
}

#qrcode{
    background:#fff;
    padding:16px;
    border-radius:20px;
    margin:18px auto;
    animation:pulse 2.2s infinite;
}
@keyframes pulse{
    0%{box-shadow:0 0 0 rgba(0,242,96,0)}
    50%{box-shadow:0 0 30px rgba(0,242,96,.7)}
    100%{box-shadow:0 0 0 rgba(0,242,96,0)}
}

input,button{
    width:100%;
    padding:13px;
    border-radius:14px;
    border:none;
    margin-top:12px;
    font-size:15px;
}

button{
    background:linear-gradient(135deg,#00f260,#0575e6);
    color:#fff;
    cursor:pointer;
    transition:.3s;
}
button:hover{
    transform:scale(1.05);
    box-shadow:0 12px 30px rgba(0,0,0,.4);
}

.admin-dot{
    position:fixed;
    bottom:18px;
    right:18px;
    width:14px;
    height:14px;
    background:#00f260;
    border-radius:50%;
    box-shadow:0 0 15px #00f260;
    cursor:pointer;
}

.admin-box{
    position:fixed;
    bottom:48px;
    right:18px;
    background:#0b0b0b;
    padding:16px;
    border-radius:14px;
    width:260px;
    box-shadow:0 20px 50px rgba(0,0,0,.6);
}
.hidden{display:none}

   <style> 
</head>

<body>

<div class="card">
    <h3>Scan & Pay</h3>

    <div id="qrcode"></div>

    <input type="number" id="amount" placeholder="Enter amount (optional)">
    <button onclick="pay()">Pay Now</button>
</div>

<!-- ADMIN DOT -->
<div class="admin-dot" onclick="toggleAdmin()"></div>

<!-- ADMIN PANEL -->
<div class="admin-box hidden" id="adminBox">
    <input type="password" id="adminPass" placeholder="Admin Password">
    <button onclick="adminLogin()">Login</button>

    <div id="adminPanel" class="hidden">
        <input type="text" id="adminUpi" placeholder="Update UPI ID">
        <input type="number" id="adminAmt" placeholder="Default Amount">
        <button onclick="saveAdmin()">Save</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
/* ================= CONFIG ================= */
let UPI_ID = "shop.mitra@ybl";
let DEFAULT_AMOUNT = "";

const ADMIN_HASH = "5f1b9e4b9b92e2a8c7a7f9f4bcb2a7e56f6e7e64b9a3bb4b7a0c9c2b4f7f0d9a";

let attempts = 0;
let lockedUntil = 0;

/* ================= QR ================= */
const qrBox = document.getElementById("qrcode");

function makeQR(amount=""){
    qrBox.innerHTML = "";
    let link = `upi://pay?pa=${UPI_ID}&pn=Payment&cu=INR`;
    if(amount) link += `&am=${amount}`;
    new QRCode(qrBox,{text:link,width:180,height:180});
}
makeQR();

function pay(){
    const amt = document.getElementById("amount").value || DEFAULT_AMOUNT;
    let link = `upi://pay?pa=${UPI_ID}&pn=Payment&cu=INR`;
    if(amt) link += `&am=${amt}`;
    window.location.href = link;
}

/* ================= ADMIN OPEN (LONG PRESS) ================= */
let pressTimer;
const adminDot = document.querySelector(".admin-dot");

adminDot.addEventListener("touchstart", startPress);
adminDot.addEventListener("mousedown", startPress);
adminDot.addEventListener("touchend", cancelPress);
adminDot.addEventListener("mouseup", cancelPress);

function startPress(){
    pressTimer = setTimeout(()=>{
        document.getElementById("adminBox").classList.remove("hidden");
    },3000); // 3 sec long press
}
function cancelPress(){
    clearTimeout(pressTimer);
}

/* ================= HASH ================= */
async function sha256(msg){
    const buf = new TextEncoder().encode(msg);
    const hash = await crypto.subtle.digest("SHA-256", buf);
    return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,"0")).join("");
}

/* ================= ADMIN LOGIN ================= */
async function adminLogin(){
    const now = Date.now();
    if(now < lockedUntil){
        alert("Admin locked. Try later.");
        return;
    }

    const input = document.getElementById("adminPass").value;
    const hash = await sha256(input);

    if(hash === ADMIN_HASH){
        attempts = 0;
        document.getElementById("adminPanel").classList.remove("hidden");
    }else{
        attempts++;
        alert("Wrong password");

        if(attempts >= 3){
            lockedUntil = now + (5 * 60 * 1000); // 5 min lock
            alert("Too many attempts. Locked for 5 minutes.");
        }
    }
}

/* ================= ADMIN SAVE ================= */
function saveAdmin(){
    const u = document.getElementById("adminUpi").value.trim();
    const a = document.getElementById("adminAmt").value;

    if(u && !u.includes("@")){
        alert("Invalid UPI");
        return;
    }

    if(u) UPI_ID = u;
    DEFAULT_AMOUNT = a;

    makeQR(DEFAULT_AMOUNT);
    alert("Updated securely");
}
</script>

</body>
</html>
